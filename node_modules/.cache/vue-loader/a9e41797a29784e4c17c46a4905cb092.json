{"remainingRequest":"D:\\beeko\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\beeko\\src\\components\\profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\beeko\\src\\components\\profile.vue","mtime":1584872811585},{"path":"D:\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1567240333000},{"path":"D:\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdQcm9maWxlJywNCiAgZGF0YTogKCkgPT4gKHsNCiAgICBzaWduZWR1cDpmYWxzZSwNCiAgICBhdmF0YXJVcGxvYWRlZDpmYWxzZSwNCiAgICB1cGRhdGVkOmZhbHNlLA0KICAgIGZvcm1Jc1ZhbGlkOmZhbHNlLA0KICAgIHZhbGlkOnRydWUsDQogICAgLy9wcm9maWxlOnsnbmFtZSc6JycsICdlbWFpbCc6JycsICdwaG9uZSc6JycsICdhdmF0YXInOicnfSwNCiAgICBuYW1lUnVsZXM6IFsNCiAgICAgICAgdiA9PiAhIXYgfHwgJ9Ce0LHQvtCyYNGP0LfQutC+0LLQtSDQv9C+0LvQtScNCiAgICBdLA0KICAgIGVtYWlsUnVsZXM6IFsNCiAgICAgICAgdiA9PiAvLitALisvLnRlc3QodikgfHwgJ9Cd0LXQstGW0YDQvdC40LkgZS1tYWlsJywNCiAgICBdDQogIH0pLA0KICBtb3VudGVkKCl7DQogICAgaWYodHlwZW9mKHRoaXMuJHJvdXRlLnBhcmFtcy5zaWduZWR1cCkgIT0gJ3VuZGVmaW5lZCcpew0KICAgICAgdGhpcy5zaWduZWR1cCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5zaWduZWR1cDsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6ew0KICAgIHZhbGlkYXRlRm9ybSgpew0KICAgICAgaWYgKHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZSgpKSB7DQogICAgICAgIHRoaXMuZm9ybUlzVmFsaWQgPSB0cnVlOw0KICAgICAgfSBlbHNlew0KICAgICAgICAgdGhpcy5mb3JtSXNWYWxpZCA9IGZhbHNlOw0KICAgICAgfQ0KICAgIH0sDQogICAgdXBsb2FkQXZhdGFyKGZpbGUpew0KICAgICAgbGV0IHN0b3JlID0gdGhpcy4kc3RvcmU7DQogICAgICBsZXQgZmlyZWJhc2UgPSB0aGlzLiRmaXJlYmFzZTsNCiAgICAgIGxldCByZWYgPSB0aGlzOw0KICAgICAgZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpLmNoaWxkKCdhdmF0YXJzLycrdGhpcy4kZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyLnVpZCkucHV0KGZpbGUpLnRoZW4oZnVuY3Rpb24oc25hcHNob3QpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnVXBsb2FkZWQgYSBibG9iIG9yIGZpbGUhJytzbmFwc2hvdCk7DQogICAgICAgICAgLy9nZXQgdXJsDQogICAgICAgICAgc25hcHNob3QucmVmLmdldERvd25sb2FkVVJMKCkudGhlbihmdW5jdGlvbih1cmwpIHsNCiAgICAgICAgICBzdG9yZS5zdGF0ZS5kYi5jb2xsZWN0aW9uKCd1c2VycycpLmRvYyhmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkKS51cGRhdGUoeydhdmF0YXInOnVybH0pOw0KICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZmlsZUF2YXRhcicpLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDsNCiAgICAgICAgICAgIHJlZi5hdmF0YXJVcGxvYWRlZCA9IHRydWU7DQogICAgICAgICAgICBzZXRUaW1lb3V0KA0KICAgICAgICAgICAgICBmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIHJlZi5hdmF0YXJVcGxvYWRlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICB9LDMwMDApOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHNhdmVJbmZvKCl7DQogICAgICBpZih0aGlzLmZvcm1Jc1ZhbGlkKXsNCiAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZGIuY29sbGVjdGlvbigidXNlcnMiKS5kb2ModGhpcy4kZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyLnVpZCkudXBkYXRlKHsnbmFtZSc6ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJOYW1lJykudmFsdWUsICdlbWFpbCc6ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJFbWFpbCcpLnZhbHVlfSk7DQogICAgICAgIHRoaXMudXBkYXRlZD10cnVlOw0KICAgICAgICBsZXQgcmVkaXJlY3QgPSB0aGlzLiRyb3V0ZXI7DQoNCiAgICAgICAgc2V0VGltZW91dCgNCiAgICAgICAgICBmdW5jdGlvbigpew0KICAgICAgICAgICAgLy9yZWRpcmVjdCB0byBhY2NvdW50DQogICAgICAgICAgIHJlZGlyZWN0LnB1c2goe3BhdGg6J3FyJywgbmFtZTonUXInfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgICwzMDAwDQogICAgICAgICk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAgYWxlcnQoJ9Ck0L7RgNC80LAg0LfQsNC/0L7QstC90LXQvdCwINC90LXQstGW0YDQvdC+IScpOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2lnbk91dCgpew0KICAgICAgaWYoY29uZmlybSgn0JLQuCDQtNGW0LnRgdC90L4g0YXQvtGH0LXRgtC1INCy0LjQudGC0Lgg0Lcg0LTQvtC00LDRgtC60YM/Jykpew0KICAgICAgICBsZXQgcmVmID0gdGhpczsNCiAgICAgICAgcmVmLiRmaXJlYmFzZS5hdXRoKCkuc2lnbk91dCgpLnRoZW4oDQogICAgICAgICAgKCk9PnsNCiAgICAgICAgICAgIHJlZi4kc3RvcmUuc3RhdGUudXNlciA9IGZhbHNlOw0KICAgICAgICAgICAgcmVmLiRyb3V0ZXIucHVzaCh7cGF0aDonc2lnbnVwJywgbmFtZTonU2lnbnVwJywgcGFyYW1zOntsb2dvdXQ6MX19KTsNCiAgICAgICAgICB9DQogICAgICAgICk7DQogICAgICB9DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"profile.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-layout text-center wrap>\r\n      <v-flex xs12>\r\n         <template>\r\n           <div>\r\n          <h1  class=\"headline\" style=\"color:orange\">Мій профіль</h1> \r\n          <v-btn absolute=\"\" top right small\r\n            id=\"signOutBtn\"\r\n            color=\"success\"\r\n            outlined=\"\"\r\n            class=\"mr-4\"\r\n            @click=\"signOut\"\r\n          >\r\n            <v-icon>mdi-arrow-right</v-icon>\r\n          </v-btn>\r\n          </div>\r\n          <br/>\r\n          <div class=\"text-center\" v-if=\"signedup\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Вітаємо у BeEco!</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"!$store.state.user.email\">\r\n            <v-alert color=\"orange lighten-2\" style=\"padding-top:7px\"><v-icon>mdi-email</v-icon>Вкажіть свій e-mail на випадок зміни номеру телефона</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"avatarUploaded\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Аватар оновлено!</v-alert>\r\n          </div>\r\n          <img id='profileAvatar' v-if=\"$store.state.user.avatar\" v-bind:src=\"$store.state.user.avatar\" width=\"150\" />\r\n          <img id='profileAvatar' v-else src=\"\" width=\"150\" />\r\n          <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\r\n              <v-file-input outlined id=\"avatarUpload\" label=\"Загрузить аватар\" accept=\"image/*\" @change=\"uploadAvatar($event)\"></v-file-input>\r\n              <v-text-field v-model=\"$store.state.user.name\" outlined id=\"userName\" label=\"Имя\" :rules=\"nameRules\" @change=\"validateForm\" required></v-text-field>\r\n              <v-text-field v-model=\"$store.state.user.email\" outlined id=\"userEmail\" label=\"E-mail\" :rules=\"emailRules\" @change=\"validateForm\"></v-text-field>\r\n              <div class=\"text-center\" v-if=\"updated\">\r\n                <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Інформацію оновлено!</v-alert>\r\n              </div>\r\n              <v-btn\r\n                id=\"submitForm\"\r\n                :disabled=\"!formIsValid\"\r\n                color=\"success\"\r\n                class=\"mr-4\"\r\n                @click=\"saveInfo\"\r\n              >\r\n                Зберегти\r\n              </v-btn>\r\n            </v-form> \r\n          </template>\r\n      </v-flex>\r\n      </v-layout>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Profile',\r\n  data: () => ({\r\n    signedup:false,\r\n    avatarUploaded:false,\r\n    updated:false,\r\n    formIsValid:false,\r\n    valid:true,\r\n    //profile:{'name':'', 'email':'', 'phone':'', 'avatar':''},\r\n    nameRules: [\r\n        v => !!v || 'Обов`язкове поле'\r\n    ],\r\n    emailRules: [\r\n        v => /.+@.+/.test(v) || 'Невірний e-mail',\r\n    ]\r\n  }),\r\n  mounted(){\r\n    if(typeof(this.$route.params.signedup) != 'undefined'){\r\n      this.signedup = this.$route.params.signedup;\r\n    }\r\n  },\r\n  methods:{\r\n    validateForm(){\r\n      if (this.$refs.form.validate()) {\r\n        this.formIsValid = true;\r\n      } else{\r\n         this.formIsValid = false;\r\n      }\r\n    },\r\n    uploadAvatar(file){\r\n      let store = this.$store;\r\n      let firebase = this.$firebase;\r\n      let ref = this;\r\n      firebase.storage().ref().child('avatars/'+this.$firebase.auth().currentUser.uid).put(file).then(function(snapshot) {\r\n          console.log('Uploaded a blob or file!'+snapshot);\r\n          //get url\r\n          snapshot.ref.getDownloadURL().then(function(url) {\r\n          store.state.db.collection('users').doc(firebase.auth().currentUser.uid).update({'avatar':url});\r\n          var reader = new FileReader();\r\n          reader.onload = function(e) {\r\n            document.getElementById('profileAvatar').src = e.target.result;\r\n            ref.avatarUploaded = true;\r\n            setTimeout(\r\n              function(){\r\n                ref.avatarUploaded = false;\r\n              },3000);\r\n          }\r\n          reader.readAsDataURL(file);\r\n        });\r\n      });\r\n    },\r\n    saveInfo(){\r\n      if(this.formIsValid){\r\n        this.$store.state.db.collection(\"users\").doc(this.$firebase.auth().currentUser.uid).update({'name':document.getElementById('userName').value, 'email':document.getElementById('userEmail').value});\r\n        this.updated=true;\r\n        let redirect = this.$router;\r\n\r\n        setTimeout(\r\n          function(){\r\n            //redirect to account\r\n           redirect.push({path:'qr', name:'Qr'});\r\n          }\r\n          ,3000\r\n        );\r\n      } else {\r\n         alert('Форма заповнена невірно!');\r\n      }\r\n    },\r\n    signOut(){\r\n      if(confirm('Ви дійсно хочете вийти з додатку?')){\r\n        let ref = this;\r\n        ref.$firebase.auth().signOut().then(\r\n          ()=>{\r\n            ref.$store.state.user = false;\r\n            ref.$router.push({path:'signup', name:'Signup', params:{logout:1}});\r\n          }\r\n        );\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}