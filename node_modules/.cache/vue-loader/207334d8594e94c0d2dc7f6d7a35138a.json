{"remainingRequest":"D:\\beeko\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\beeko\\src\\components\\profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\beeko\\src\\components\\profile.vue","mtime":1578762123499},{"path":"D:\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1567240333000},{"path":"D:\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\beeko\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdQcm9maWxlJywNCiAgZGF0YTogKCkgPT4gKHsNCiAgICBzaWduZWR1cDpmYWxzZSwNCiAgICB1cGRhdGVkOmZhbHNlLA0KICAgIGZvcm1Jc1ZhbGlkOmZhbHNlLA0KICAgIHZhbGlkOnRydWUsDQogICAgcHJvZmlsZTp7J25hbWUnOicnLCAnZW1haWwnOicnLCAncGhvbmUnOicnLCAnYXZhdGFyJzonJ30sDQogICAgbmFtZVJ1bGVzOiBbDQogICAgICAgIHYgPT4gISF2IHx8ICfQntCx0L7QsmDRj9C30LrQvtCy0LUg0L/QvtC70LUnDQogICAgXSwNCiAgICBlbWFpbFJ1bGVzOiBbDQogICAgICAgIHYgPT4gLy4rQC4rLy50ZXN0KHYpIHx8ICfQndC10L/RgNCw0LLQuNC70YzQvdGL0LkgZS1tYWlsJywNCiAgICBdDQogIH0pLA0KICBjcmVhdGVkKCl7DQogICAgaWYodHlwZW9mKHRoaXMuJHJvdXRlLnBhcmFtcy5zaWduZWR1cCkgIT0gJ3VuZGVmaW5lZCcpew0KICAgICAgdGhpcy5zaWduZWR1cCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5zaWduZWR1cDsNCiAgICB9DQogICAgdGhpcy5wcm9maWxlID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlcjsNCiAgfSwNCiAgbWV0aG9kczp7DQogICAgdmFsaWRhdGVGb3JtKCl7DQogICAgICBpZiAodGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCkpIHsNCiAgICAgICAgdGhpcy5mb3JtSXNWYWxpZCA9IHRydWU7DQogICAgICB9IGVsc2V7DQogICAgICAgICB0aGlzLmZvcm1Jc1ZhbGlkID0gZmFsc2U7DQogICAgICB9DQogICAgfSwNCiAgICB1cGxvYWRBdmF0YXIoZmlsZSl7DQogICAgICBsZXQgc3RvcmUgPSB0aGlzLiRzdG9yZTsNCiAgICAgIGxldCBmaXJlYmFzZSA9IHRoaXMuJGZpcmViYXNlOw0KICAgICAgZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpLmNoaWxkKCdhdmF0YXJzLycrdGhpcy4kZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyLnVpZCkucHV0KGZpbGUpLnRoZW4oZnVuY3Rpb24oc25hcHNob3QpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ1VwbG9hZGVkIGEgYmxvYiBvciBmaWxlIScrc25hcHNob3QpOw0KICAgICAgICAvL2dldCB1cmwNCiAgICAgICAgc25hcHNob3QucmVmLmdldERvd25sb2FkVVJMKCkudGhlbihmdW5jdGlvbih1cmwpIHsNCiAgICAgICAgICBzdG9yZS5zdGF0ZS5kYi5jb2xsZWN0aW9uKCd1c2VycycpLmRvYyhmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkKS51cGRhdGUoeydhdmF0YXInOnVybH0pOw0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgc2F2ZUluZm8oKXsNCiAgICAgIGlmKHRoaXMuZm9ybUlzVmFsaWQpew0KICAgICAgICBhbGVydCgnZm9ybSBpcyB2YWxpZCcpOw0KICAgICAgICBhbGVydChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlck5hbWUnKS52YWx1ZStkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlckVtYWlsJykudmFsdWUpOw0KICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5kYi5jb2xsZWN0aW9uKCJ1c2VycyIpLmRvYyh0aGlzLiRmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkKS51cGRhdGUoeyduYW1lJzpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlck5hbWUnKS52YWx1ZSwgJ2VtYWlsJzpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlckVtYWlsJykudmFsdWV9KTsNCiAgICAgICAgdGhpcy51cGRhdGVkPXRydWU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAgYWxlcnQoJ2Zvcm0gaXMgTk9UIHZhbGlkJyk7DQogICAgICB9DQogICAgfSwNCiAgICBzaWduT3V0KCl7DQogICAgICAgIGxldCByZWYgPSB0aGlzOw0KICAgICAgICByZWYuJGZpcmViYXNlLmF1dGgoKS5zaWduT3V0KCkudGhlbigNCiAgICAgICAgICAoKT0+ew0KICAgICAgICAgICAgcmVmLiRzdG9yZS5zdGF0ZS51c2VyID0gZmFsc2U7DQogICAgICAgICAgICByZWYuJHJvdXRlci5wdXNoKHtwYXRoOidzaWdudXAnLCBuYW1lOidTaWdudXAnLCBwYXJhbXM6e2xvZ291dDoxfX0pOw0KICAgICAgICAgIH0NCiAgICAgICAgKTsNCiAgICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"profile.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-layout text-center wrap>\r\n      <v-flex xs12>\r\n         <template>\r\n           <div>\r\n          <h1  class=\"headline\" style=\"color:orange\">Мій профіль</h1> \r\n          <v-btn justify-end\r\n            id=\"signOutBtn\"\r\n            color=\"success\"\r\n            outlined=\"\"\r\n            class=\"mr-4\"\r\n            @click=\"signOut\"\r\n          >\r\n            Вийти <v-icon x-small>mdi-arrow-right</v-icon>\r\n          </v-btn>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"signedup\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Вітаємо у BeEco!</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"updated\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Інформацію оновлено!</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"!$store.state.user.email\">\r\n            <v-alert color=\"orange lighten-2\" style=\"padding-top:7px\"><v-icon>mdi-email</v-icon>Вкажіть свій e-mail на випадок зміни номеру телефона</v-alert>\r\n          </div>\r\n          \r\n          <img v-bind:src=\"$store.state.user.avatar\" width=\"150\" />\r\n          <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\r\n              <v-file-input outlined id=\"avatarUpload\" label=\"Загрузить аватар\" accept=\"image/*\" @change=\"uploadAvatar($event)\"></v-file-input>\r\n              <v-text-field v-model=\"profile.name\" outlined id=\"userName\" label=\"Имя\" :rules=\"nameRules\" @change=\"validateForm\" required></v-text-field>\r\n              <v-text-field v-model=\"profile.email\" outlined id=\"userEmail\" label=\"E-mail\" :rules=\"emailRules\" @change=\"validateForm\"></v-text-field>\r\n              <v-btn\r\n                id=\"submitForm\"\r\n                :disabled=\"!formIsValid\"\r\n                color=\"success\"\r\n                class=\"mr-4\"\r\n                @click=\"saveInfo\"\r\n              >\r\n                Зберегти\r\n              </v-btn>\r\n            </v-form> \r\n          </template>\r\n      </v-flex>\r\n      </v-layout>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Profile',\r\n  data: () => ({\r\n    signedup:false,\r\n    updated:false,\r\n    formIsValid:false,\r\n    valid:true,\r\n    profile:{'name':'', 'email':'', 'phone':'', 'avatar':''},\r\n    nameRules: [\r\n        v => !!v || 'Обов`язкове поле'\r\n    ],\r\n    emailRules: [\r\n        v => /.+@.+/.test(v) || 'Неправильный e-mail',\r\n    ]\r\n  }),\r\n  created(){\r\n    if(typeof(this.$route.params.signedup) != 'undefined'){\r\n      this.signedup = this.$route.params.signedup;\r\n    }\r\n    this.profile = this.$store.state.user;\r\n  },\r\n  methods:{\r\n    validateForm(){\r\n      if (this.$refs.form.validate()) {\r\n        this.formIsValid = true;\r\n      } else{\r\n         this.formIsValid = false;\r\n      }\r\n    },\r\n    uploadAvatar(file){\r\n      let store = this.$store;\r\n      let firebase = this.$firebase;\r\n      firebase.storage().ref().child('avatars/'+this.$firebase.auth().currentUser.uid).put(file).then(function(snapshot) {\r\n        console.log('Uploaded a blob or file!'+snapshot);\r\n        //get url\r\n        snapshot.ref.getDownloadURL().then(function(url) {\r\n          store.state.db.collection('users').doc(firebase.auth().currentUser.uid).update({'avatar':url});\r\n        });\r\n      });\r\n    },\r\n    saveInfo(){\r\n      if(this.formIsValid){\r\n        alert('form is valid');\r\n        alert(document.getElementById('userName').value+document.getElementById('userEmail').value);\r\n        this.$store.state.db.collection(\"users\").doc(this.$firebase.auth().currentUser.uid).update({'name':document.getElementById('userName').value, 'email':document.getElementById('userEmail').value});\r\n        this.updated=true;\r\n      } else {\r\n         alert('form is NOT valid');\r\n      }\r\n    },\r\n    signOut(){\r\n        let ref = this;\r\n        ref.$firebase.auth().signOut().then(\r\n          ()=>{\r\n            ref.$store.state.user = false;\r\n            ref.$router.push({path:'signup', name:'Signup', params:{logout:1}});\r\n          }\r\n        );\r\n      }\r\n  }\r\n};\r\n</script>\r\n"]}]}