{"remainingRequest":"C:\\APPS\\beeko\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\APPS\\beeko\\src\\components\\profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\APPS\\beeko\\src\\components\\profile.vue","mtime":1596958446000},{"path":"C:\\APPS\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\APPS\\beeko\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\APPS\\beeko\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1567240334000},{"path":"C:\\APPS\\beeko\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\APPS\\beeko\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdQcm9maWxlJywNCiAgZGF0YTogKCkgPT4gKHsNCiAgICBzaWduZWR1cDpmYWxzZSwNCiAgICBhdmF0YXJVcGxvYWRlZDpmYWxzZSwNCiAgICB1cGRhdGVkOmZhbHNlLA0KICAgIGZvcm1Jc1ZhbGlkOmZhbHNlLA0KICAgIHZhbGlkOnRydWUsDQogICAgLy9wcm9maWxlOnsnbmFtZSc6JycsICdlbWFpbCc6JycsICdwaG9uZSc6JycsICdhdmF0YXInOicnfSwNCiAgICBydWxlczogWw0KICAgICAgICB2ID0+ICEhdiB8fCAn0J7QsdC+0LJg0Y/Qt9C60L7QstC1INC/0L7Qu9C1Jw0KICAgIF0sDQogICAgZW1haWxSdWxlczogWw0KICAgICAgICB2ID0+IC8uK0AuKy8udGVzdCh2KSB8fCAn0J3QtdCy0ZbRgNC90LjQuSBlLW1haWwnLA0KICAgIF0NCiAgfSksDQogIG1vdW50ZWQoKXsNCiAgICBpZih0eXBlb2YodGhpcy4kcm91dGUucGFyYW1zLnNpZ25lZHVwKSAhPSAndW5kZWZpbmVkJyl7DQogICAgICB0aGlzLnNpZ25lZHVwID0gdGhpcy4kcm91dGUucGFyYW1zLnNpZ25lZHVwOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczp7DQogICAgdmFsaWRhdGVGb3JtKCl7DQogICAgICBpZiAodGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCkpIHsNCiAgICAgICAgdGhpcy5mb3JtSXNWYWxpZCA9IHRydWU7DQogICAgICB9IGVsc2V7DQogICAgICAgICB0aGlzLmZvcm1Jc1ZhbGlkID0gZmFsc2U7DQogICAgICB9DQogICAgfSwNCiAgICB1cGxvYWRBdmF0YXIoZmlsZSl7DQogICAgICBsZXQgc3RvcmUgPSB0aGlzLiRzdG9yZTsNCiAgICAgIGxldCBmaXJlYmFzZSA9IHRoaXMuJGZpcmViYXNlOw0KICAgICAgbGV0IHJlZiA9IHRoaXM7DQogICAgICBmaXJlYmFzZS5zdG9yYWdlKCkucmVmKCkuY2hpbGQoJ2F2YXRhcnMvJyt0aGlzLiRmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkKS5wdXQoZmlsZSkudGhlbihmdW5jdGlvbihzbmFwc2hvdCkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGxvYWRlZCBhIGJsb2Igb3IgZmlsZSEnK3NuYXBzaG90KTsNCiAgICAgICAgICAvL2dldCB1cmwNCiAgICAgICAgICBzbmFwc2hvdC5yZWYuZ2V0RG93bmxvYWRVUkwoKS50aGVuKGZ1bmN0aW9uKHVybCkgew0KICAgICAgICAgIHN0b3JlLnN0YXRlLmRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZG9jKGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci51aWQpLnVwZGF0ZSh7J2F2YXRhcic6dXJsfSk7DQogICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9maWxlQXZhdGFyJykuc3JjID0gZS50YXJnZXQucmVzdWx0Ow0KICAgICAgICAgICAgcmVmLmF2YXRhclVwbG9hZGVkID0gdHJ1ZTsNCiAgICAgICAgICAgIHNldFRpbWVvdXQoDQogICAgICAgICAgICAgIGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgcmVmLmF2YXRhclVwbG9hZGVkID0gZmFsc2U7DQogICAgICAgICAgICAgIH0sMzAwMCk7DQogICAgICAgICAgfQ0KICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOw0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgc2F2ZUluZm8oKXsNCiAgICAgIGlmKHRoaXMuZm9ybUlzVmFsaWQpew0KICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5kYi5jb2xsZWN0aW9uKCJ1c2VycyIpLmRvYyh0aGlzLiRmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkKS51cGRhdGUoeyduYW1lJzpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlck5hbWUnKS52YWx1ZSwgJ2VtYWlsJzpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlckVtYWlsJykudmFsdWUsICdwaG9uZSc6ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJQaG9uZScpLnZhbHVlfSk7DQogICAgICAgIHRoaXMudXBkYXRlZD10cnVlOw0KICAgICAgICBsZXQgcmVkaXJlY3QgPSB0aGlzLiRyb3V0ZXI7DQoNCiAgICAgICAgc2V0VGltZW91dCgNCiAgICAgICAgICBmdW5jdGlvbigpew0KICAgICAgICAgICAgLy9yZWRpcmVjdCB0byBhY2NvdW50DQogICAgICAgICAgIHJlZGlyZWN0LnB1c2goe3BhdGg6J3FyJywgbmFtZTonUXInfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgICwzMDAwDQogICAgICAgICk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAgYWxlcnQoJ9Ck0L7RgNC80LAg0LfQsNC/0L7QstC90LXQvdCwINC90LXQstGW0YDQvdC+IScpOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2lnbk91dCgpew0KICAgICAgaWYoY29uZmlybSgn0JLQuCDQtNGW0LnRgdC90L4g0YXQvtGH0LXRgtC1INCy0LjQudGC0Lgg0Lcg0LTQvtC00LDRgtC60YM/Jykpew0KICAgICAgICBsZXQgcmVmID0gdGhpczsNCiAgICAgICAgcmVmLiRmaXJlYmFzZS5hdXRoKCkuc2lnbk91dCgpLnRoZW4oDQogICAgICAgICAgKCk9PnsNCiAgICAgICAgICAgIHJlZi4kc3RvcmUuc3RhdGUudXNlciA9IGZhbHNlOw0KICAgICAgICAgICAgcmVmLiRyb3V0ZXIucHVzaCh7cGF0aDonc2lnbnVwJywgbmFtZTonU2lnbnVwJywgcGFyYW1zOntsb2dvdXQ6MX19KTsNCiAgICAgICAgICB9DQogICAgICAgICk7DQogICAgICB9DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"profile.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-layout text-center wrap>\r\n      <v-flex xs12>\r\n         <template>\r\n           <div>\r\n          <h1  class=\"headline\" style=\"color:orange\">Мій профіль</h1> \r\n          <v-btn absolute=\"\" top right small\r\n            id=\"signOutBtn\"\r\n            color=\"success\"\r\n            outlined=\"\"\r\n            class=\"mr-4\"\r\n            @click=\"signOut\"\r\n          >\r\n            <v-icon>mdi-arrow-right</v-icon>\r\n          </v-btn>\r\n          </div>\r\n          <br/>\r\n          <div class=\"text-center\" v-if=\"signedup\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Вітаємо у BeEco!</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"!$store.state.user.email\">\r\n            <v-alert color=\"orange lighten-2\" style=\"padding-top:7px\"><v-icon>mdi-email</v-icon>Вкажіть свій e-mail на випадок зміни номеру телефона</v-alert>\r\n          </div>\r\n          <div class=\"text-center\" v-if=\"avatarUploaded\">\r\n            <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Аватар оновлено!</v-alert>\r\n          </div>\r\n          <img id='profileAvatar' v-if=\"$store.state.user.avatar\" v-bind:src=\"$store.state.user.avatar\" width=\"150\" />\r\n          <img id='profileAvatar' v-else src=\"\" width=\"150\" />\r\n          <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\r\n              <v-file-input outlined id=\"avatarUpload\" label=\"Загрузить аватар\" accept=\"image/*\" @change=\"uploadAvatar($event)\"></v-file-input>\r\n              <v-text-field v-model=\"$store.state.user.name\" outlined id=\"userName\" label=\"Имя\" :rules=\"rules\" @change=\"validateForm\" required></v-text-field>\r\n              <v-text-field v-model=\"$store.state.user.phone\" outlined id=\"userPhone\" type=\"number\" label=\"Телефон\" thumb-label :rules=\"rules\" @change=\"validateForm\" required></v-text-field>\r\n              <v-text-field v-model=\"$store.state.user.email\" outlined id=\"userEmail\" label=\"E-mail\" :rules=\"emailRules\" @change=\"validateForm\"></v-text-field>\r\n              <div class=\"text-center\" v-if=\"updated\">\r\n                <v-alert color=\"green lighten-2\" height=\"40\" style=\"padding-top:7px\">Інформацію оновлено!</v-alert>\r\n              </div>\r\n              <v-btn\r\n                id=\"submitForm\"\r\n                :disabled=\"!formIsValid\"\r\n                color=\"success\"\r\n                class=\"mr-4\"\r\n                @click=\"saveInfo\"\r\n              >\r\n                Зберегти\r\n              </v-btn>\r\n            </v-form> \r\n          </template>\r\n      </v-flex>\r\n      </v-layout>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Profile',\r\n  data: () => ({\r\n    signedup:false,\r\n    avatarUploaded:false,\r\n    updated:false,\r\n    formIsValid:false,\r\n    valid:true,\r\n    //profile:{'name':'', 'email':'', 'phone':'', 'avatar':''},\r\n    rules: [\r\n        v => !!v || 'Обов`язкове поле'\r\n    ],\r\n    emailRules: [\r\n        v => /.+@.+/.test(v) || 'Невірний e-mail',\r\n    ]\r\n  }),\r\n  mounted(){\r\n    if(typeof(this.$route.params.signedup) != 'undefined'){\r\n      this.signedup = this.$route.params.signedup;\r\n    }\r\n  },\r\n  methods:{\r\n    validateForm(){\r\n      if (this.$refs.form.validate()) {\r\n        this.formIsValid = true;\r\n      } else{\r\n         this.formIsValid = false;\r\n      }\r\n    },\r\n    uploadAvatar(file){\r\n      let store = this.$store;\r\n      let firebase = this.$firebase;\r\n      let ref = this;\r\n      firebase.storage().ref().child('avatars/'+this.$firebase.auth().currentUser.uid).put(file).then(function(snapshot) {\r\n          console.log('Uploaded a blob or file!'+snapshot);\r\n          //get url\r\n          snapshot.ref.getDownloadURL().then(function(url) {\r\n          store.state.db.collection('users').doc(firebase.auth().currentUser.uid).update({'avatar':url});\r\n          var reader = new FileReader();\r\n          reader.onload = function(e) {\r\n            document.getElementById('profileAvatar').src = e.target.result;\r\n            ref.avatarUploaded = true;\r\n            setTimeout(\r\n              function(){\r\n                ref.avatarUploaded = false;\r\n              },3000);\r\n          }\r\n          reader.readAsDataURL(file);\r\n        });\r\n      });\r\n    },\r\n    saveInfo(){\r\n      if(this.formIsValid){\r\n        this.$store.state.db.collection(\"users\").doc(this.$firebase.auth().currentUser.uid).update({'name':document.getElementById('userName').value, 'email':document.getElementById('userEmail').value, 'phone':document.getElementById('userPhone').value});\r\n        this.updated=true;\r\n        let redirect = this.$router;\r\n\r\n        setTimeout(\r\n          function(){\r\n            //redirect to account\r\n           redirect.push({path:'qr', name:'Qr'});\r\n          }\r\n          ,3000\r\n        );\r\n      } else {\r\n         alert('Форма заповнена невірно!');\r\n      }\r\n    },\r\n    signOut(){\r\n      if(confirm('Ви дійсно хочете вийти з додатку?')){\r\n        let ref = this;\r\n        ref.$firebase.auth().signOut().then(\r\n          ()=>{\r\n            ref.$store.state.user = false;\r\n            ref.$router.push({path:'signup', name:'Signup', params:{logout:1}});\r\n          }\r\n        );\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}