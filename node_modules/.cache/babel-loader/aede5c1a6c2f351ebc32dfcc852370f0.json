{"remainingRequest":"C:\\apps\\beeko2\\node_modules\\babel-loader\\lib\\index.js!C:\\APPS\\beeko2\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\apps\\beeko2\\src\\util\\permissions.js","dependencies":[{"path":"C:\\apps\\beeko2\\src\\util\\permissions.js","mtime":1606854338430},{"path":"C:\\apps\\beeko2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\apps\\beeko2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\APPS\\beeko2\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOlxcYXBwc1xcYmVla28yXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS1jb3JlanMzL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcYXBwc1xcYmVla28yXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS1jb3JlanMzL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKZXhwb3J0IHZhciBQZXJtaXNzaW9ucyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBlcm1pc3Npb25zKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBlcm1pc3Npb25zKTsKICB9CgogIF9jcmVhdGVDbGFzcyhQZXJtaXNzaW9ucywgW3sKICAgIGtleTogIk9TIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gJ2FuZHJvaWQgJzsKICAgIH0KICB9XSwgW3sKICAgIGtleTogImNhbWVyYSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgc3dpdGNoICh0aGlzLk9TKSB7CiAgICAgICAgY2FzZSAnYW5kcm9pZCc6CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAnYW5kcm9pZC5wZXJtaXNzaW9uLkNBTUVSQSc7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2NhdGlvbiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgc3dpdGNoICh0aGlzLk9TKSB7CiAgICAgICAgY2FzZSAnYW5kcm9pZCc6CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAnYW5kcm9pZC5wZXJtaXNzaW9uLkFDQ0VTU19GSU5FX0xPQ0FUSU9OJzsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBlcm1pc3Npb25zOwp9KCk7Cgp2YXIgZ2V0UGVybWlzc2lvbkJvb2xlYW5TdGF0dXMgPSBmdW5jdGlvbiBnZXRQZXJtaXNzaW9uQm9vbGVhblN0YXR1cyhyZXMpIHsKICByZXR1cm4gZnVuY3Rpb24gKHN0YXR1cykgewogICAgcmV0dXJuIHN0YXR1cy5oYXNQZXJtaXNzaW9uID8gcmVzKHRydWUpIDogcmVzKGZhbHNlKTsKICB9Owp9OwoKdmFyIGdldEFuZHJvaWRQZXJtaXNzaW9uID0gZnVuY3Rpb24gZ2V0QW5kcm9pZFBlcm1pc3Npb24ocHJtLCBfY29yZG92YSkgewogIGlmICghcHJtKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ3BybSBpcyB1bmRlZmluZWQnKTsKICB9CgogIGlmICghX2NvcmRvdmEpIHsKICAgIHRocm93IG5ldyBFcnJvcignY29yZG92YSBpcyB1bmRlZmluZWQnKTsKICB9CgogIHZhciBwZXJtaXNzaW9ucyA9IF9jb3Jkb3ZhLnBsdWdpbnMucGVybWlzc2lvbnM7CiAgdmFyIHBlcm1Qcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlKSB7CiAgICB2YXIgYWxyZWFkeUhhc0NhbWVyYVBlcm0sIGFxdWlyZWRQZXJtOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAobmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHBlcm1pc3Npb25zLmNoZWNrUGVybWlzc2lvbihwcm0sIGdldFBlcm1pc3Npb25Cb29sZWFuU3RhdHVzKHJlcyksIHJlaik7CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGFscmVhZHlIYXNDYW1lcmFQZXJtID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgIGlmICghYWxyZWFkeUhhc0NhbWVyYVBlcm0pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzb2x2ZSh0cnVlKSk7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHsKICAgICAgICAgICAgICByZXR1cm4gcGVybWlzc2lvbnMucmVxdWVzdFBlcm1pc3Npb24ocHJtLCBnZXRQZXJtaXNzaW9uQm9vbGVhblN0YXR1cyhyZXMpLCByZWopOwogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBhcXVpcmVkUGVybSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICBpZiAoYXF1aXJlZFBlcm0pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlc29sdmUoZmFsc2UpKTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXNvbHZlKHRydWUpKTsKCiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0pOwogIHJldHVybiBwZXJtUHJvbWlzZTsKfTsKCmV4cG9ydCB2YXIgZ2V0UGVybWlzc2lvbiA9IGZ1bmN0aW9uIGdldFBlcm1pc3Npb24ocHJtKSB7CiAgdmFyIF9jb3Jkb3ZhLAogICAgICBwZXJtaXNzaW9ucywKICAgICAgcGVybWlzc2lvbiwKICAgICAgX2FyZ3MyID0gYXJndW1lbnRzOwoKICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIGdldFBlcm1pc3Npb24kKF9jb250ZXh0MikgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgX2NvcmRvdmEgPSBfYXJnczIubGVuZ3RoID4gMSAmJiBfYXJnczJbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMlsxXSA6IHdpbmRvdy5jb3Jkb3ZhOwogICAgICAgICAgcGVybWlzc2lvbnMgPSBfY29yZG92YS5wbHVnaW5zLnBlcm1pc3Npb25zOwoKICAgICAgICAgIGlmICghcGVybWlzc2lvbnMpIHsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1OwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcChnZXRBbmRyb2lkUGVybWlzc2lvbihwcm0sIF9jb3Jkb3ZhKSk7CgogICAgICAgIGNhc2UgNToKICAgICAgICAgIHBlcm1pc3Npb24gPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAocGVybWlzc2lvbik7CgogICAgICAgIGNhc2UgODoKICAgICAgICAgIGlmICghX2NvbnRleHQyLnNlbnQpIHsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICBjYXNlIDEyOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxNToKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgY2FzZSAxNjoKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9KTsKfTs="},{"version":3,"sources":["C:/apps/beeko2/src/util/permissions.js"],"names":["Permissions","OS","getPermissionBooleanStatus","res","status","hasPermission","getAndroidPermission","prm","_cordova","Error","permissions","plugins","permPromise","Promise","resolve","rej","checkPermission","alreadyHasCameraPerm","requestPermission","aquiredPerm","getPermission","window","cordova","permission"],"mappings":";;;;AAAA,WAAaA,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,wBACU;AACR,aAAO,UAAP;AACA;AAHF;AAAA;AAAA,wBAKqB;AACnB,cAAQ,KAAKC,EAAb;AACC,aAAK,SAAL;AACA;AACC,iBAAO,2BAAP;AAHF;AAKA;AAXF;AAAA;AAAA,wBAauB;AACrB,cAAQ,KAAKA,EAAb;AACC,aAAK,SAAL;AACA;AACC,iBAAO,yCAAP;AAHF;AAKA;AAnBF;;AAAA;AAAA;;AAsBA,IAAMC,0BAA0B,GAAG,SAA7BA,0BAA6B,CAACC,GAAD;AAAA,SAAS,UAACC,MAAD;AAAA,WAC3CA,MAAM,CAACC,aAAP,GAAuBF,GAAG,CAAC,IAAD,CAA1B,GAAmCA,GAAG,CAAC,KAAD,CADK;AAAA,GAAT;AAAA,CAAnC;;AAGA,IAAMG,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,GAAD,EAAMC,QAAN,EAAmB;AAC/C,MAAI,CAACD,GAAL,EAAU;AACT,UAAM,IAAIE,KAAJ,CAAU,kBAAV,CAAN;AACA;;AACD,MAAI,CAACD,QAAL,EAAe;AACd,UAAM,IAAIC,KAAJ,CAAU,sBAAV,CAAN;AACA;;AAED,MAAMC,WAAW,GAAGF,QAAQ,CAACG,OAAT,CAAiBD,WAArC;AAEA,MAAME,WAAW,GAAG,IAAIC,OAAJ,CAAY,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CACI,IAAID,OAAJ,CAAY,UAACV,GAAD,EAAMY,GAAN;AAAA,qBAC9CL,WAAW,CAACM,eAAZ,CAA4BT,GAA5B,EAAiCL,0BAA0B,CAACC,GAAD,CAA3D,EAAkEY,GAAlE,CAD8C;AAAA,aAAZ,CADJ;;AAAA;AACzBE,YAAAA,oBADyB;;AAAA,iBAK3BA,oBAL2B;AAAA;AAAA;AAAA;;AAAA,6CAMvBH,OAAO,CAAC,IAAD,CANgB;;AAAA;AAAA;AAAA,4CAQJ,IAAID,OAAJ,CAAY,UAACV,GAAD,EAAMY,GAAN;AAAA,qBACrCL,WAAW,CAACQ,iBAAZ,CAA8BX,GAA9B,EAAmCL,0BAA0B,CAACC,GAAD,CAA7D,EAAoEY,GAApE,CADqC;AAAA,aAAZ,CARI;;AAAA;AAQxBI,YAAAA,WARwB;;AAAA,gBAWzBA,WAXyB;AAAA;AAAA;AAAA;;AAAA,6CAgBtBL,OAAO,CAAC,KAAD,CAhBe;;AAAA;AAAA,6CAkBvBA,OAAO,CAAC,IAAD,CAlBgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAZ,CAApB;AAsBA,SAAOF,WAAP;AACA,CAjCD;;AAmCA,OAAO,IAAMQ,aAAa,GAAG,SAAhBA,aAAgB,CAAOb,GAAP;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAYC,UAAAA,QAAZ,8DAAuBa,MAAM,CAACC,OAA9B;AACtBZ,UAAAA,WADsB,GACRF,QAAQ,CAACG,OAAT,CAAiBD,WADT;;AAAA,eAGxBA,WAHwB;AAAA;AAAA;AAAA;;AAAA;AAAA,0CAIFJ,oBAAoB,CAACC,GAAD,EAAMC,QAAN,CAJlB;;AAAA;AAIrBe,UAAAA,UAJqB;AAAA;AAAA,0CAKjBA,UALiB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,4CAMnB,IANmB;;AAAA;AAAA,4CAQnB,KARmB;;AAAA;AAAA;AAAA;;AAAA;AAAA,4CAcpB,IAdoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB","sourcesContent":["export class Permissions {\n\tget OS() {\n\t\treturn 'android ';\n\t}\n\n\tstatic get camera() {\n\t\tswitch (this.OS) {\n\t\t\tcase 'android':\n\t\t\tdefault:\n\t\t\t\treturn 'android.permission.CAMERA';\n\t\t}\n\t}\n\n\tstatic get location() {\n\t\tswitch (this.OS) {\n\t\t\tcase 'android':\n\t\t\tdefault:\n\t\t\t\treturn 'android.permission.ACCESS_FINE_LOCATION';\n\t\t}\n\t}\n}\n\nconst getPermissionBooleanStatus = (res) => (status) =>\n\tstatus.hasPermission ? res(true) : res(false);\n\nconst getAndroidPermission = (prm, _cordova) => {\n\tif (!prm) {\n\t\tthrow new Error('prm is undefined');\n\t}\n\tif (!_cordova) {\n\t\tthrow new Error('cordova is undefined');\n\t}\n\n\tconst permissions = _cordova.plugins.permissions;\n\n\tconst permPromise = new Promise(async (resolve) => {\n\t\tconst alreadyHasCameraPerm = await new Promise((res, rej) =>\n\t\t\tpermissions.checkPermission(prm, getPermissionBooleanStatus(res), rej)\n\t\t);\n\n\t\tif (alreadyHasCameraPerm) {\n\t\t\treturn resolve(true);\n\t\t} else {\n\t\t\tconst aquiredPerm = await new Promise((res, rej) =>\n\t\t\t\tpermissions.requestPermission(prm, getPermissionBooleanStatus(res), rej)\n\t\t\t);\n\t\t\tif (!aquiredPerm) {\n\t\t\t\t// try-catch approach\n\t\t\t\t// return reject(new Error('User forbid camera usage'))\n\n\t\t\t\t// true-false response approach\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\treturn resolve(true);\n\t\t}\n\t});\n\n\treturn permPromise;\n};\n\nexport const getPermission = async (prm, _cordova = window.cordova) => {\n\tconst permissions = _cordova.plugins.permissions;\n\n\tif (permissions) {\n\t\tconst permission = await getAndroidPermission(prm, _cordova);\n\t\tif (await permission) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// handle ios permissions\n\t// else if (permissionsIOS) {}\n\telse {\n\t\treturn true;\n\t}\n};\n"]}]}